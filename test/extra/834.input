*-------------------------------------------------------------------------------
* Molecule: Water dimer
* Basis: cc-pVDZ
* Symmetry: C1
* Features tested: Molcas/Gromacs interface
* Responsible person: Michael Stenrup
* Comments: Only run test if interface is installed
*-------------------------------------------------------------------------------
* Test if Gromacs is available and skip the test if not
> RM -FORCE TEST_GROMACS
> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>   EXPORT MOLCAS_DRIVER=molcas
> ENDIF
> SHELL $MOLCAS_DRIVER have_feature gromacs || touch TEST_GROMACS
> IF ( -FILE TEST_GROMACS )
>   EXIT 36
> ENDIF
*-------------------------------------------------------------------------------
> FILE conf.gro
Water dimer
   6
    1SOLQM   OW    1   -.155   -.011    .000
    1SOLQM  HW1    2   -.193    .076    .000
    1SOLQM  HW2    3   -.039   -.012   -.000
    2SOL     OW    4    .224    .016    .116
    2SOL    HW1    5    .264   -.036    .046
    2SOL    HW2    6    .253   -.035    .177
   1.0 1.0 1.0
> EOF
*-------------------------------------------------------------------------------
> FILE index.ndx
[ System ]
 1 2 3 4 5 6
[ QM ]
 1 2 3
[ MM ]
 4 5 6
> EOF
*-------------------------------------------------------------------------------
> FILE topol.top
#include "oplsaa.ff/forcefield.itp"
#include "oplsaa.ff/spc.itp"
#include "spcqm.itp"

[ system ]
 Water dimer

[ molecules ]
 SOLQM 1
 SOL 1
> EOF
*-------------------------------------------------------------------------------
> FILE spcqm.itp
[ moleculetype ]
 SOLQM 2

[ atoms ]
 1 opls_116 1 SOLQM  OW 1 -0.82
 2 opls_117 1 SOLQM HW1 1  0.41
 3 opls_117 1 SOLQM HW2 1  0.41

[ bonds ]
 1 2 5
 1 3 5
> EOF
*-------------------------------------------------------------------------------
> FILE grompp.mdp
define = -DFLEXIBLE

cutoff-scheme = group
pbc = no
rlist = 0

coulombtype = cut-off
rcoulomb = 0

vdwtype = cut-off
rvdw = 0

QMMM = yes
QMMM-grps = QM
QMMMscheme = slave
QMmethod = CASSCF
QMbasis = STO-3G
> EOF
*-------------------------------------------------------------------------------
> SHELL grompp_d -n index
> EXPORT GMX_NB_GENERIC=1
> EXPORT GMX_MAXBACKUP=-1

&GATEWAY
Gromacs
 Simple
Basis
 cc-pVDZ
Group
 NoSym
NoCD

> DO WHILE

&SEWARD

&ESPF
External
 Gromacs
MMIterations
 1000

&SCF

&SLAPAF
Cartesian

> ENDDO
>>FILE checkfile
* This file is autogenerated:
* Molcas version 18.09-531-ge0632f48
* Linux serrano 3.13.0-162-generic #212-Ubuntu SMP Mon Oct 29 12:08:50 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
* Mon May 20 16:50:28 2019
*
#>>   1
#> POTNUC="8.406904165079"/12
#>>   2
#> POTNUC="8.406904165079"/6
#> SEWARD_MLTPL1X="-2.929075493170"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.151990197910"/5
#>>   3
#> POTNUC="8.330488832533"/6
#>>   4
#> SCF_ITER="10"/8
#> E_SCF="-75.970962302007"/8
#> ESPF_MULTIPOLES[0]="-0.752820096086"/6
#> ESPF_MULTIPOLES[1]="0.386250889294"/6
#> ESPF_MULTIPOLES[2]="0.366389942735"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.514593287981"/5
#> MLTPL__1[1]="0.613221017850"/5
#> MLTPL__1[2]="0.0"/5
#> MLTPL__2[0]="1.888518000998"/5
#> MLTPL__2[1]="-1.190723807540"/5
#> MLTPL__2[2]="0.0"/5
#> MLTPL__2[3]="0.040538519192"/5
#> MLTPL__2[4]="0.0"/5
#> MLTPL__2[5]="-1.929056520190"/5
#>>   5
#> GRAD[0]="-0.115071545502"/6
#> GRAD[1]="0.019677516499"/6
#> GRAD[2]="0.0"/6
#> GRAD[3]="-0.021208716273"/6
#> GRAD[4]="-0.002032951735"/6
#> GRAD[5]="0.0"/6
#> GRAD[6]="0.136280261775"/6
#> GRAD[7]="-0.017644564764"/6
#> GRAD[8]="0.0"/6
#> GRAD[0]="-0.111080115286"/6
#> GRAD[1]="0.022570624867"/6
#> GRAD[2]="0.000909608877"/6
#> GRAD[3]="-0.020148849201"/6
#> GRAD[4]="-0.004584954806"/6
#> GRAD[5]="-0.000382971619"/6
#> GRAD[6]="0.130114236068"/6
#> GRAD[7]="-0.018539509168"/6
#> GRAD[8]="-0.001527677522"/6
#>>   6
#>>   7
#>>   9
#> POTNUC="8.956226282456"/6
#> SEWARD_MLTPL1X="-2.899537103414"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.216082434581"/5
#>>  10
#> POTNUC="8.640358494405"/6
#>>  11
#> SCF_ITER="9"/8
#> E_SCF="-76.033034665327"/8
#> ESPF_MULTIPOLES[0]="-0.802815960801"/6
#> ESPF_MULTIPOLES[1]="0.369096649799"/6
#> ESPF_MULTIPOLES[2]="0.433949935927"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.592755442142"/5
#> MLTPL__1[1]="0.665002672452"/5
#> MLTPL__1[2]="0.000743659114"/5
#> MLTPL__2[0]="1.485577188364"/5
#> MLTPL__2[1]="-0.850315358955"/5
#> MLTPL__2[2]="0.007599923832"/5
#> MLTPL__2[3]="0.248894063274"/5
#> MLTPL__2[4]="-0.000973806604"/5
#> MLTPL__2[5]="-1.734471251638"/5
#>>  12
#> GRAD[0]="-0.074124830845"/6
#> GRAD[1]="-0.010351590751"/6
#> GRAD[2]="-0.000577022248"/6
#> GRAD[3]="-0.012180373720"/6
#> GRAD[4]="0.009913748930"/6
#> GRAD[5]="0.000005423747"/6
#> GRAD[6]="0.086305204566"/6
#> GRAD[7]="0.000437841821"/6
#> GRAD[8]="0.000571598501"/6
#> GRAD[0]="-0.045586181101"/6
#> GRAD[1]="-0.002248543410"/6
#> GRAD[2]="0.001024749918"/6
#> GRAD[3]="-0.008540308419"/6
#> GRAD[4]="0.004617800361"/6
#> GRAD[5]="0.000036915796"/6
#> GRAD[6]="0.052806449337"/6
#> GRAD[7]="-0.002268089798"/6
#> GRAD[8]="-0.001748953035"/6
#>>  13
#>>  14
#>>  16
#> POTNUC="9.439036450112"/6
#> SEWARD_MLTPL1X="-2.875913859897"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.273405282558"/5
#>>  17
#> POTNUC="9.148633441337"/6
#>>  18
#> SCF_ITER="8"/8
#> E_SCF="-76.034899959268"/8
#> ESPF_MULTIPOLES[0]="-0.800790993169"/6
#> ESPF_MULTIPOLES[1]="0.369091469262"/6
#> ESPF_MULTIPOLES[2]="0.431997922938"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.532726569425"/5
#> MLTPL__1[1]="0.674667024650"/5
#> MLTPL__1[2]="0.008361091309"/5
#> MLTPL__2[0]="1.129189404719"/5
#> MLTPL__2[1]="-0.763628185358"/5
#> MLTPL__2[2]="0.036604781266"/5
#> MLTPL__2[3]="0.437715392300"/5
#> MLTPL__2[4]="-0.007946903956"/5
#> MLTPL__2[5]="-1.566904797019"/5
#>>  19
#> GRAD[0]="0.022520995197"/6
#> GRAD[1]="-0.008362905771"/6
#> GRAD[2]="0.000323374890"/6
#> GRAD[3]="-0.003286661674"/6
#> GRAD[4]="0.007322112350"/6
#> GRAD[5]="-0.000035036291"/6
#> GRAD[6]="-0.019234333522"/6
#> GRAD[7]="0.001040793421"/6
#> GRAD[8]="-0.000288338599"/6
#> GRAD[0]="0.045777644575"/6
#> GRAD[1]="0.000956474018"/6
#> GRAD[2]="0.001447393403"/6
#> GRAD[3]="-0.000296903826"/6
#> GRAD[4]="0.001525073916"/6
#> GRAD[5]="0.000093346212"/6
#> GRAD[6]="-0.045966353016"/6
#> GRAD[7]="-0.002571211909"/6
#> GRAD[8]="-0.001873115661"/6
#>>  20
#>>  21
#>>  23
#> POTNUC="9.223968062356"/6
#> SEWARD_MLTPL1X="-2.886221190532"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.247620601379"/5
#>>  24
#> POTNUC="8.922823081364"/6
#>>  25
#> SCF_ITER="8"/8
#> E_SCF="-76.036428831247"/8
#> ESPF_MULTIPOLES[0]="-0.797554702487"/6
#> ESPF_MULTIPOLES[1]="0.367969875886"/6
#> ESPF_MULTIPOLES[2]="0.429844417946"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563119502881"/5
#> MLTPL__1[1]="0.672729938206"/5
#> MLTPL__1[2]="0.009350840253"/5
#> MLTPL__2[0]="1.265843049088"/5
#> MLTPL__2[1]="-0.768695442969"/5
#> MLTPL__2[2]="0.042775113514"/5
#> MLTPL__2[3]="0.365706082680"/5
#> MLTPL__2[4]="-0.009187129070"/5
#> MLTPL__2[5]="-1.631549131768"/5
#>>  26
#> GRAD[0]="-0.032534748300"/6
#> GRAD[1]="-0.008502161950"/6
#> GRAD[2]="-0.000458236182"/6
#> GRAD[3]="-0.004417449833"/6
#> GRAD[4]="0.005202472275"/6
#> GRAD[5]="-0.000062761004"/6
#> GRAD[6]="0.036952198133"/6
#> GRAD[7]="0.003299689675"/6
#> GRAD[8]="0.000520997186"/6
#> GRAD[0]="-0.007222969672"/6
#> GRAD[1]="0.000659285324"/6
#> GRAD[2]="0.000783508270"/6
#> GRAD[3]="-0.001318367990"/6
#> GRAD[4]="-0.000437016511"/6
#> GRAD[5]="0.000073256519"/6
#> GRAD[6]="0.007515246168"/6
#> GRAD[7]="-0.000228461655"/6
#> GRAD[8]="-0.001393585166"/6
#>>  27
#>>  28
#>>  30
#> POTNUC="9.254142162624"/6
#> SEWARD_MLTPL1X="-2.883263109219"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.251140062986"/5
#>>  31
#> POTNUC="8.952899858371"/6
#>>  32
#> SCF_ITER="8"/8
#> E_SCF="-76.036501430923"/8
#> ESPF_MULTIPOLES[0]="-0.796956472803"/6
#> ESPF_MULTIPOLES[1]="0.367410364211"/6
#> ESPF_MULTIPOLES[2]="0.429804201430"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.562194893876"/5
#> MLTPL__1[1]="0.673378640859"/5
#> MLTPL__1[2]="0.012330855606"/5
#> MLTPL__2[0]="1.237402271909"/5
#> MLTPL__2[1]="-0.756836049444"/5
#> MLTPL__2[2]="0.057439117199"/5
#> MLTPL__2[3]="0.382719966851"/5
#> MLTPL__2[4]="-0.013078597769"/5
#> MLTPL__2[5]="-1.620122238760"/5
#>>  33
#> GRAD[0]="-0.026485604755"/6
#> GRAD[1]="-0.009084017746"/6
#> GRAD[2]="-0.000493960067"/6
#> GRAD[3]="-0.003559269747"/6
#> GRAD[4]="0.005345455785"/6
#> GRAD[5]="-0.000069607305"/6
#> GRAD[6]="0.030044874501"/6
#> GRAD[7]="0.003738561960"/6
#> GRAD[8]="0.000563567372"/6
#> GRAD[0]="-0.001159749689"/6
#> GRAD[1]="0.000223627458"/6
#> GRAD[2]="0.000793654759"/6
#> GRAD[3]="-0.000515047372"/6
#> GRAD[4]="-0.000339028054"/6
#> GRAD[5]="0.000095422897"/6
#> GRAD[6]="0.000782914364"/6
#> GRAD[7]="0.000138509436"/6
#> GRAD[8]="-0.001351138814"/6
#>>  34
#> GEO_ITER="5"/8
#> POTNUC="9.262650039042"/6
#> SEWARD_MLTPL1X="-2.880521999801"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.252107692725"/5
#> POTNUC="8.961134455356"/6
#> SCF_ITER="7"/8
#> E_SCF="-76.036547679925"/8
#> ESPF_MULTIPOLES[0]="-0.797516140458"/6
#> ESPF_MULTIPOLES[1]="0.367602561224"/6
#> ESPF_MULTIPOLES[2]="0.430210664915"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563359356634"/5
#> MLTPL__1[1]="0.673078639825"/5
#> MLTPL__1[2]="0.016474760520"/5
#> MLTPL__2[0]="1.223447678491"/5
#> MLTPL__2[1]="-0.750526827970"/5
#> MLTPL__2[2]="0.078977773341"/5
#> MLTPL__2[3]="0.392571529080"/5
#> MLTPL__2[4]="-0.019102500839"/5
#> MLTPL__2[5]="-1.616019207571"/5
#>>  35
#>>  36
>>EOF
