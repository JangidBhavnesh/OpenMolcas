*-------------------------------------------------------------------------------
* Molecule: Water dimer
* Basis: cc-pVDZ
* Symmetry: C1
* Features tested: Molcas/Gromacs interface
* Responsible person: Michael Stenrup
* Comments: Only run test if interface is installed
*-------------------------------------------------------------------------------
* Test if Gromacs is available and skip the test if not
> RM -FORCE TEST_GROMACS
> IF ( $MOLCAS_DRIVER = UNKNOWN_VARIABLE )
>   EXPORT MOLCAS_DRIVER=molcas
> ENDIF
> SHELL $MOLCAS_DRIVER have_feature gromacs || touch TEST_GROMACS
> IF ( -FILE TEST_GROMACS )
>   EXIT 36
> ENDIF
*-------------------------------------------------------------------------------
> FILE conf.gro
Water dimer
   6
    1SOLQM   OW    1   -.155   -.011    .000
    1SOLQM  HW1    2   -.193    .076    .000
    1SOLQM  HW2    3   -.039   -.012   -.000
    2SOL     OW    4    .224    .016    .116
    2SOL    HW1    5    .264   -.036    .046
    2SOL    HW2    6    .253   -.035    .177
   1.0 1.0 1.0
> EOF
*-------------------------------------------------------------------------------
> FILE index.ndx
[ System ]
 1 2 3 4 5 6
[ QM ]
 1 2 3
[ MM ]
 4 5 6
> EOF
*-------------------------------------------------------------------------------
> FILE topol.top
#include "oplsaa.ff/forcefield.itp"
#include "oplsaa.ff/spc.itp"
#include "spcqm.itp"

[ system ]
 Water dimer

[ molecules ]
 SOLQM 1
 SOL 1
> EOF
*-------------------------------------------------------------------------------
> FILE spcqm.itp
[ moleculetype ]
 SOLQM 2

[ atoms ]
 1 opls_116 1 SOLQM  OW 1 -0.82
 2 opls_117 1 SOLQM HW1 1  0.41
 3 opls_117 1 SOLQM HW2 1  0.41

[ bonds ]
 1 2 5
 1 3 5
> EOF
*-------------------------------------------------------------------------------
> FILE grompp.mdp
define = -DFLEXIBLE

cutoff-scheme = group
pbc = no
rlist = 0

coulombtype = cut-off
rcoulomb = 0

vdwtype = cut-off
rvdw = 0

QMMM = yes
QMMM-grps = QM
QMMMscheme = slave
QMmethod = CASSCF
QMbasis = STO-3G
> EOF
*-------------------------------------------------------------------------------
> SHELL grompp_d -n index
> EXPORT GMX_NB_GENERIC=1
> EXPORT GMX_MAXBACKUP=-1

&GATEWAY
Gromacs
 Simple
Basis
 cc-pVDZ
Group
 NoSym
NoCD

> DO WHILE

&SEWARD

&ESPF
External
 Gromacs
MMIterations
 1000

&SCF

&SLAPAF
Cartesian

> ENDDO
>>FILE checkfile
* This file is autogenerated:
* Molcas version 18.09-9-g0e0b217 patch level 
* Linux serrano 3.13.0-142-generic #191-Ubuntu SMP Fri Feb 2 12:13:35 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux
* Thu Sep  6 16:07:43 2018
*
#>>   1
#> POTNUC="8.406904161378"/12
#>>   2
#> POTNUC="8.406904161378"/6
#> SEWARD_MLTPL1X="-2.929075494460"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.151990197464"/5
#>>   3
#> POTNUC="8.330488828411"/6
#>>   4
#> SCF_ITER="10"/8
#> E_SCF="-75.970962302297"/8
#> ESPF_MULTIPOLES[0]="-0.752820095987"/6
#> ESPF_MULTIPOLES[1]="0.386250889239"/6
#> ESPF_MULTIPOLES[2]="0.366389942689"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.514593288016"/5
#> MLTPL__1[1]="0.613221017965"/5
#> MLTPL__1[2]="0.0"/5
#> MLTPL__2[0]="1.888518002171"/5
#> MLTPL__2[1]="-1.190723808248"/5
#> MLTPL__2[2]="0.0"/5
#> MLTPL__2[3]="0.040538519260"/5
#> MLTPL__2[4]="0.0"/5
#> MLTPL__2[5]="-1.929056521431"/5
#>>   5
#> GRAD[0]="-0.115071545411"/6
#> GRAD[1]="0.019677516076"/6
#> GRAD[2]="0.0"/6
#> GRAD[3]="-0.021208716465"/6
#> GRAD[4]="-0.002032951306"/6
#> GRAD[5]="0.0"/6
#> GRAD[6]="0.136280261877"/6
#> GRAD[7]="-0.017644564769"/6
#> GRAD[8]="0.0"/6
#> GRAD[0]="-0.111080115194"/6
#> GRAD[1]="0.022570624445"/6
#> GRAD[2]="0.000909608878"/6
#> GRAD[3]="-0.020148849395"/6
#> GRAD[4]="-0.004584954378"/6
#> GRAD[5]="-0.000382971619"/6
#> GRAD[6]="0.130114236172"/6
#> GRAD[7]="-0.018539509174"/6
#> GRAD[8]="-0.001527677522"/6
#>>   6
#>>   7
#>>   9
#> POTNUC="8.956226280282"/6
#> SEWARD_MLTPL1X="-2.899537104560"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.216082434326"/5
#>>  10
#> POTNUC="8.640092999205"/6
#>>  11
#> SCF_ITER="9"/8
#> E_SCF="-76.033046807892"/8
#> ESPF_MULTIPOLES[0]="-0.803037991392"/6
#> ESPF_MULTIPOLES[1]="0.369138904262"/6
#> ESPF_MULTIPOLES[2]="0.434129890047"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.593081515115"/5
#> MLTPL__1[1]="0.665096592102"/5
#> MLTPL__1[2]="0.000739870156"/5
#> MLTPL__2[0]="1.485931414775"/5
#> MLTPL__2[1]="-0.850294330192"/5
#> MLTPL__2[2]="0.007595496121"/5
#> MLTPL__2[3]="0.248753892537"/5
#> MLTPL__2[4]="-0.000974161792"/5
#> MLTPL__2[5]="-1.734685307312"/5
#>>  12
#> GRAD[0]="-0.074151847567"/6
#> GRAD[1]="-0.010363544151"/6
#> GRAD[2]="-0.000577888367"/6
#> GRAD[3]="-0.012188389357"/6
#> GRAD[4]="0.009920906088"/6
#> GRAD[5]="0.000005505451"/6
#> GRAD[6]="0.086340236924"/6
#> GRAD[7]="0.000442638063"/6
#> GRAD[8]="0.000572382915"/6
#> GRAD[0]="-0.045478566416"/6
#> GRAD[1]="-0.002228141853"/6
#> GRAD[2]="0.001001168953"/6
#> GRAD[3]="-0.008540850338"/6
#> GRAD[4]="0.004619837781"/6
#> GRAD[5]="0.000041735205"/6
#> GRAD[6]="0.052748149630"/6
#> GRAD[7]="-0.002304544724"/6
#> GRAD[8]="-0.001694694479"/6
#>>  13
#>>  14
#>>  16
#> POTNUC="9.437960858366"/6
#> SEWARD_MLTPL1X="-2.876110883330"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.273272446528"/5
#>>  17
#> POTNUC="9.147407445751"/6
#>>  18
#> SCF_ITER="8"/8
#> E_SCF="-76.034925466995"/8
#> ESPF_MULTIPOLES[0]="-0.800711373563"/6
#> ESPF_MULTIPOLES[1]="0.369085213152"/6
#> ESPF_MULTIPOLES[2]="0.431924669457"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.532735753642"/5
#> MLTPL__1[1]="0.674837533944"/5
#> MLTPL__1[2]="0.008160061698"/5
#> MLTPL__2[0]="1.129800319245"/5
#> MLTPL__2[1]="-0.763093713311"/5
#> MLTPL__2[2]="0.035755519869"/5
#> MLTPL__2[3]="0.437366066932"/5
#> MLTPL__2[4]="-0.007762677491"/5
#> MLTPL__2[5]="-1.567166386177"/5
#>>  19
#> GRAD[0]="0.022193338388"/6
#> GRAD[1]="-0.008388151279"/6
#> GRAD[2]="0.000311291815"/6
#> GRAD[3]="-0.003267505124"/6
#> GRAD[4]="0.007316699978"/6
#> GRAD[5]="-0.000033999095"/6
#> GRAD[6]="-0.018925833264"/6
#> GRAD[7]="0.001071451300"/6
#> GRAD[8]="-0.000277292719"/6
#> GRAD[0]="0.045422526882"/6
#> GRAD[1]="0.000955214120"/6
#> GRAD[2]="0.001416014794"/6
#> GRAD[3]="-0.000280397795"/6
#> GRAD[4]="0.001511244801"/6
#> GRAD[5]="0.000090588484"/6
#> GRAD[6]="-0.045654985280"/6
#> GRAD[7]="-0.002565550052"/6
#> GRAD[8]="-0.001838848541"/6
#>>  20
#>>  21
#>>  23
#> POTNUC="9.223998951223"/6
#> SEWARD_MLTPL1X="-2.886299667276"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.247621777944"/5
#>>  24
#> POTNUC="8.922576875508"/6
#>>  25
#> SCF_ITER="8"/8
#> E_SCF="-76.036436710678"/8
#> ESPF_MULTIPOLES[0]="-0.797527286631"/6
#> ESPF_MULTIPOLES[1]="0.367956165175"/6
#> ESPF_MULTIPOLES[2]="0.429830664771"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563036079171"/5
#> MLTPL__1[1]="0.672890275999"/5
#> MLTPL__1[2]="0.009163197257"/5
#> MLTPL__2[0]="1.265964050053"/5
#> MLTPL__2[1]="-0.768194305710"/5
#> MLTPL__2[2]="0.041926022894"/5
#> MLTPL__2[3]="0.365568128330"/5
#> MLTPL__2[4]="-0.008998615703"/5
#> MLTPL__2[5]="-1.631532178383"/5
#>>  26
#> GRAD[0]="-0.032544138544"/6
#> GRAD[1]="-0.008540510392"/6
#> GRAD[2]="-0.000449263462"/6
#> GRAD[3]="-0.004405526718"/6
#> GRAD[4]="0.005214901626"/6
#> GRAD[5]="-0.000061332029"/6
#> GRAD[6]="0.036949665262"/6
#> GRAD[7]="0.003325608765"/6
#> GRAD[8]="0.000510595490"/6
#> GRAD[0]="-0.007239513975"/6
#> GRAD[1]="0.000644986794"/6
#> GRAD[2]="0.000772512571"/6
#> GRAD[3]="-0.001305616152"/6
#> GRAD[4]="-0.000432968301"/6
#> GRAD[5]="0.000071709044"/6
#> GRAD[6]="0.007502857256"/6
#> GRAD[7]="-0.000223739853"/6
#> GRAD[8]="-0.001375345869"/6
#>>  27
#>>  28
#>>  30
#> POTNUC="9.254159123229"/6
#> SEWARD_MLTPL1X="-2.883310740366"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.251140476559"/5
#>>  31
#> POTNUC="8.952646606019"/6
#>>  32
#> SCF_ITER="7"/8
#> E_SCF="-76.036508522518"/8
#> ESPF_MULTIPOLES[0]="-0.796939059928"/6
#> ESPF_MULTIPOLES[1]="0.367401704376"/6
#> ESPF_MULTIPOLES[2]="0.429795421900"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.562075212845"/5
#> MLTPL__1[1]="0.673541609490"/5
#> MLTPL__1[2]="0.012097096165"/5
#> MLTPL__2[0]="1.237659611095"/5
#> MLTPL__2[1]="-0.756439637103"/5
#> MLTPL__2[2]="0.056361972964"/5
#> MLTPL__2[3]="0.382481714317"/5
#> MLTPL__2[4]="-0.012822942486"/5
#> MLTPL__2[5]="-1.620141325411"/5
#>>  33
#> GRAD[0]="-0.026490630226"/6
#> GRAD[1]="-0.009115193303"/6
#> GRAD[2]="-0.000484546150"/6
#> GRAD[3]="-0.003553857389"/6
#> GRAD[4]="0.005358069277"/6
#> GRAD[5]="-0.000067989791"/6
#> GRAD[6]="0.030044487615"/6
#> GRAD[7]="0.003757124026"/6
#> GRAD[8]="0.000552535942"/6
#> GRAD[0]="-0.001172432225"/6
#> GRAD[1]="0.000215515705"/6
#> GRAD[2]="0.000782215040"/6
#> GRAD[3]="-0.000508154770"/6
#> GRAD[4]="-0.000334349651"/6
#> GRAD[5]="0.000093738403"/6
#> GRAD[6]="0.000773357524"/6
#> GRAD[7]="0.000136808047"/6
#> GRAD[8]="-0.001333174329"/6
#>>  34
#> GEO_ITER="5"/8
#> POTNUC="9.262542758143"/6
#> SEWARD_MLTPL1X="-2.880538498896"/5
#> SEWARD_KINETIC="29.214928025013"/5
#> SEWARD_ATTRACT="-62.252094417105"/5
#> POTNUC="8.960753612084"/6
#> SCF_ITER="7"/8
#> E_SCF="-76.036554307295"/8
#> ESPF_MULTIPOLES[0]="-0.797513161181"/6
#> ESPF_MULTIPOLES[1]="0.367601378151"/6
#> ESPF_MULTIPOLES[2]="0.430209048586"/6
#> MLTPL__0="-0.000000000000"/5
#> MLTPL__1[0]="0.563193984148"/5
#> MLTPL__1[1]="0.673258354651"/5
#> MLTPL__1[2]="0.016159308652"/5
#> MLTPL__2[0]="1.224013686465"/5
#> MLTPL__2[1]="-0.750237264848"/5
#> MLTPL__2[2]="0.077476726241"/5
#> MLTPL__2[3]="0.392121429393"/5
#> MLTPL__2[4]="-0.018715607703"/5
#> MLTPL__2[5]="-1.616135115857"/5
#>>  35
#>>  36
>>EOF
